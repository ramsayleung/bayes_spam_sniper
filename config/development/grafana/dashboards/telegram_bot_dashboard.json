{
  "id": null,
  "title": "Telegram Spam Sniper Bot Dashboard",
  "tags": ["telegram", "bot", "spam", "monitoring"],
  "style": "dark",
  "timezone": "browser",
  "editable": true,
  "panels": [
    {
      "id": 1,
      "title": "Total Messages",
      "type": "stat",
      "gridPos": {"h": 6, "w": 6, "x": 0, "y": 0},
      "targets": [
        {
          "expr": "sum(increase(telegram_bot_messages_processed[$__range]))",
          "legendFormat": "Total Messages",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 100},
              {"color": "red", "value": 500}
            ]
          },
          "unit": "short",
          "decimals": 0
        }
      },
      "options": {
        "textMode": "value_and_name",
        "colorMode": "background"
      }
    },
    {
      "id": 2,
      "title": "Total Spam Detected",
      "type": "stat",
      "gridPos": {"h": 6, "w": 6, "x": 6, "y": 0},
      "targets": [
        {
          "expr": "sum(increase(telegram_bot_spam_messages_detected[$__range]))",
          "legendFormat": "Spam Messages",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 10},
              {"color": "red", "value": 50}
            ]
          },
          "unit": "short",
          "decimals": 0
        }
      },
      "options": {
        "textMode": "value_and_name",
        "colorMode": "background"
      }
    },
    {
      "id": 3,
      "title": "Spam Detection Rate %",
      "type": "stat",
      "gridPos": {"h": 6, "w": 6, "x": 12, "y": 0},
      "targets": [
        {
          "expr": "(sum(increase(telegram_bot_spam_messages_detected[$__range])) / sum(increase(telegram_bot_messages_processed[$__range]))) * 100",
          "legendFormat": "Spam Rate",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 15},
              {"color": "orange", "value": 25},
              {"color": "red", "value": 35}
            ]
          },
          "unit": "percent",
          "decimals": 1
        }
      },
      "options": {
        "textMode": "value_and_name",
        "colorMode": "background"
      }
    },
    {
      "id": 4,
      "title": "Avg Processing Time",
      "type": "stat",
      "gridPos": {"h": 6, "w": 6, "x": 18, "y": 0},
      "targets": [
        {
          "expr": "sum(rate(telegram_bot_message_processing_time_sum[$__rate_interval])) / sum(rate(telegram_bot_message_processing_time_count[$__rate_interval]))",
          "legendFormat": "Avg Time",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 0.5},
              {"color": "red", "value": 2.0}
            ]
          },
          "unit": "s",
          "decimals": 3
        }
      },
      "options": {
        "textMode": "value_and_name",
        "colorMode": "background"
      }
    },
    {
      "id": 5,
      "title": "Command Usage",
      "type": "stat",
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 6},
      "targets": [
        {
          "expr": "increase(telegram_bot_command_count[$__range])",
          "legendFormat": "{{command}}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "unit": "short",
          "decimals": 0
        }
      },
      "options": {
        "orientation": "horizontal",
        "textMode": "value_and_name",
        "displayMode": "gradient"
      }
    },
    {
      "id": 6,
      "title": "Messages Per Minute by Group",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 14},
      "targets": [
        {
          "expr": "rate(telegram_bot_messages_processed{group_id!=\"\"}[$__rate_interval]) * 60",
          "legendFormat": "{{group_name}} ({{group_id}})",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 10,
            "showPoints": "never"
          },
          "unit": "short",
          "min": 0
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    },
    {
      "id": 7,
      "title": "Total Messages Per Minute (All Groups)",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 14},
      "targets": [
        {
          "expr": "sum(rate(telegram_bot_messages_processed[$__rate_interval])) * 60",
          "legendFormat": "Total Messages/min",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 10,
            "showPoints": "never"
          },
          "unit": "short",
          "min": 0
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    },
    {
      "id": 8,
      "title": "Spam Per Minute by Group",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 22},
      "targets": [
        {
          "expr": "rate(telegram_bot_spam_messages_detected{group_id!=\"\"}[$__rate_interval]) * 60",
          "legendFormat": "{{group_name}} spam/min",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 10,
            "showPoints": "never"
          },
          "unit": "short",
          "min": 0
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    },
    {
      "id": 9,
      "title": "Total Spam Per Minute (All Groups)",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 22},
      "targets": [
        {
          "expr": "sum(rate(telegram_bot_spam_messages_detected[$__rate_interval])) * 60",
          "legendFormat": "Total Spam/min",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 10,
            "showPoints": "never"
          },
          "unit": "short",
          "min": 0
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    },
    {
      "id": 10,
      "title": "Messages by Group - Table",
      "type": "table",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 30},
      "targets": [
        {
          "expr": "increase(telegram_bot_messages_processed{group_id!=\"\"}[$__range])",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "__name__": true,
              "instance": true,
              "job": true
            },
            "renameByName": {
              "group_id": "Group ID",
              "group_name": "Group Name",
              "Value": "Messages"
            }
          }
        },
        {
          "id": "sortBy",
          "options": {
            "fields": {},
            "sort": [{"field": "Messages", "desc": true}]
          }
        }
      ]
    },
    {
      "id": 11,
      "title": "Spam by Group - Table",
      "type": "table",
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 30},
      "targets": [
        {
          "expr": "increase(telegram_bot_spam_messages_detected{group_id!=\"\"}[$__range])",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "__name__": true,
              "instance": true,
              "job": true
            },
            "renameByName": {
              "group_id": "Group ID",
              "group_name": "Group Name",
              "Value": "Spam Detected"
            }
          }
        },
        {
          "id": "sortBy",
          "options": {
            "fields": {},
            "sort": [{"field": "Spam Detected", "desc": true}]
          }
        }
      ]
    },
    {
      "id": 12,
      "title": "Spam Detection Rate % by Group",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 38},
      "targets": [
        {
          "expr": "(rate(telegram_bot_spam_messages_detected{group_id!=\"\"}[$__rate_interval]) / rate(telegram_bot_messages_processed{group_id!=\"\"}[$__rate_interval])) * 100",
          "legendFormat": "{{group_name}} spam rate %",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 10,
            "showPoints": "never"
          },
          "unit": "percent",
          "min": 0,
          "max": 100
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    },
    {
      "id": 13,
      "title": "Processing Time Percentiles (All Groups)",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 46},
      "targets": [
        {
          "expr": "histogram_quantile(0.99, sum(rate(telegram_bot_message_processing_time_bucket[$__rate_interval])) by (le))",
          "legendFormat": "P99 (99th percentile)",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.95, sum(rate(telegram_bot_message_processing_time_bucket[$__rate_interval])) by (le))",
          "legendFormat": "P95 (95th percentile)",
          "refId": "B"
        },
        {
          "expr": "histogram_quantile(0.50, sum(rate(telegram_bot_message_processing_time_bucket[$__rate_interval])) by (le))",
          "legendFormat": "P50 (Median)",
          "refId": "C"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 0,
            "showPoints": "never"
          },
          "unit": "s",
          "min": 0
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    },
    {
      "id": 14,
      "title": "Processing Time P95 by Group",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 46},
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(telegram_bot_message_processing_time_bucket{group_id!=\"\"}[$__rate_interval])) by (le, group_id, group_name))",
          "legendFormat": "{{group_name}} P95",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 0,
            "showPoints": "never"
          },
          "unit": "s",
          "min": 0
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    },
    {
      "id": 15,
      "title": "Cumulative Totals (All Time)",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 54},
      "targets": [
        {
          "expr": "sum(telegram_bot_messages_processed)",
          "legendFormat": "Total Messages (all time)",
          "refId": "A"
        },
        {
          "expr": "sum(telegram_bot_spam_messages_detected)",
          "legendFormat": "Total Spam (all time)",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 0,
            "showPoints": "never"
          },
          "unit": "short",
          "min": 0
        }
      },
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      }
    }
  ],
  "time": {
    "from": "now-1h",
    "to": "now"
  },
  "timepicker": {
    "time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "2d", "7d", "30d"]
  },
  "templating": {"list": []},
  "annotations": {"list": []},
  "refresh": "10s",
  "schemaVersion": 36,
  "version": 0,
  "links": []
}
